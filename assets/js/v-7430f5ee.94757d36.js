"use strict";(self.webpackChunkwhat_is_new_in_php=self.webpackChunkwhat_is_new_in_php||[]).push([[660],{7041:(n,s,a)=>{a.r(s),a.d(s,{data:()=>p});const p={key:"v-7430f5ee",path:"/8.0/",title:"PHP 8.0",lang:"zh-CN",frontmatter:{sidebarDepth:3,sidebar:"auto"},excerpt:"",headers:[{level:2,title:"Nullsafe 运算符",slug:"nullsafe-运算符",children:[]},{level:2,title:"Match 表达式",slug:"match-表达式",children:[]},{level:2,title:"构造器属性提升",slug:"构造器属性提升",children:[]},{level:2,title:"允许对象的 ::class",slug:"允许对象的-class",children:[]},{level:2,title:"命名参数",slug:"命名参数",children:[]},{level:2,title:"新的内建函数",slug:"新的内建函数",children:[{level:3,title:"字符串 str_starts_with()、 str_ends_with()、str_contains() 函数",slug:"字符串-str-starts-with-、-str-ends-with-、str-contains-函数",children:[]},{level:3,title:"get_debug_type 函数",slug:"get-debug-type-函数",children:[]}]},{level:2,title:"Weak Map 类",slug:"weak-map-类",children:[]},{level:2,title:"联合类型",slug:"联合类型",children:[]},{level:2,title:"Attributes 注解",slug:"attributes-注解",children:[]},{level:2,title:"throw 作为表达式",slug:"throw-作为表达式",children:[]},{level:2,title:"无变量捕捉",slug:"无变量捕捉",children:[]},{level:2,title:"新的混合伪类型",slug:"新的混合伪类型",children:[]},{level:2,title:"新 Stringable 接口",slug:"新-stringable-接口",children:[]},{level:2,title:"尾随逗号",slug:"尾随逗号",children:[]},{level:2,title:"ValueError 错误类型",slug:"valueerror-错误类型",children:[]}],filePathRelative:"8.0/README.md",git:{updatedTime:1646965991e3,contributors:[]}}},2996:(n,s,a)=>{a.r(s),a.d(s,{default:()=>rs});var p=a(6252);const e=(0,p._)("h1",{id:"php-8-0",tabindex:"-1"},[(0,p._)("a",{class:"header-anchor",href:"#php-8-0","aria-hidden":"true"},"#"),(0,p.Uk)(" PHP 8.0")],-1),t={id:"nullsafe-运算符",tabindex:"-1"},l=(0,p._)("a",{class:"header-anchor",href:"#nullsafe-运算符","aria-hidden":"true"},"#",-1),o=(0,p.Uk)(),c={href:"https://www.php.net/releases/8.0/zh.php#nullsafe-operator",target:"_blank",rel:"noopener noreferrer"},r=(0,p.Uk)("Nullsafe 运算符"),i=(0,p.uE)('<p>现在可以用新的 nullsafe 运算符链式调用，而不需要条件检查 null。 如果链条中的一个元素失败了，整个链条会中止并认定为 Null。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">profile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token constant">null</span><span class="token punctuation">;</span> <span class="token comment">// return new Profile;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">Profile</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">employment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string single-quoted-string">&#39;web development&#39;</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n\n<span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 之前的写法，先判断是否存在，再进行调用</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$profile</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">profile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$profile</span><span class="token operator">-&gt;</span><span class="token function">employment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 8.0 允许通过 nullsafe 进行链式调用</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">profile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?-&gt;</span><span class="token function">employment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string single-quoted-string">&#39;Not Provider&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div>',2),u={id:"match-表达式",tabindex:"-1"},k=(0,p._)("a",{class:"header-anchor",href:"#match-表达式","aria-hidden":"true"},"#",-1),b=(0,p.Uk)(),m={href:"https://www.php.net/releases/8.0/zh.php#match-expression",target:"_blank",rel:"noopener noreferrer"},d=(0,p.Uk)("Match 表达式"),h=(0,p.uE)('<p>新的 <code>match</code> 类似于 <code>switch</code>，并具有以下功能：</p><ul><li>Match 是一个表达式，它可以储存到变量中亦可以直接返回。</li><li>Match 分支仅支持单行，它不需要一个 <code>break;</code> 语句。</li><li>Match 使用严格比较。</li></ul><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">Conversation</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//</span>\n<span class="token punctuation">}</span>\n\n<span class="token variable">$object</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Conversation</span><span class="token punctuation">;</span>\n\n<span class="token comment">//switch (get_class($object)) {</span>\n<span class="token comment">//    case &#39;Conversation&#39;:</span>\n<span class="token comment">//        $type = &#39;started_conversation&#39;;</span>\n<span class="token comment">//        break;</span>\n<span class="token comment">//</span>\n<span class="token comment">//    case &#39;Reply&#39;:</span>\n<span class="token comment">//        $type = &#39;replied_to_conversation&#39;;</span>\n<span class="token comment">//        break;</span>\n<span class="token comment">//</span>\n<span class="token comment">//    case &#39;Comment&#39;:</span>\n<span class="token comment">//        $type = &#39;commented_to_conversation&#39;;</span>\n<span class="token comment">//        break;</span>\n<span class="token comment">//}</span>\n\n<span class="token comment">// 使用match表达式简化写法</span>\n<span class="token variable">$type</span> <span class="token operator">=</span> <span class="token keyword">match</span> <span class="token punctuation">(</span><span class="token function">get_class</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token string single-quoted-string">&#39;Conversation&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;stated_conversation&#39;</span><span class="token punctuation">,</span>\n    <span class="token string single-quoted-string">&#39;Reply&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;replied_to_conversation&#39;</span><span class="token punctuation">,</span>\n    <span class="token string single-quoted-string">&#39;Comment&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;commented_to_conversation&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">echo</span> <span class="token variable">$type</span><span class="token punctuation">;</span>\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div>',3),g={id:"构造器属性提升",tabindex:"-1"},v=(0,p._)("a",{class:"header-anchor",href:"#构造器属性提升","aria-hidden":"true"},"#",-1),w=(0,p.Uk)(),f={href:"https://www.php.net/releases/8.0/zh.php#constructor-property-promotion",target:"_blank",rel:"noopener noreferrer"},y=(0,p.Uk)("构造器属性提升"),_=(0,p.uE)('<p>在 PHP 8.0 中我们可以通过编写更少的代码来定义并初始化类属性。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token keyword">protected</span> <span class="token keyword type-declaration">string</span> <span class="token variable">$name</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">Plan</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token keyword">protected</span> <span class="token keyword type-declaration">string</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;monthly&#39;</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">Signup</span>\n<span class="token punctuation">{</span>\n    <span class="token doc-comment comment">/**\n     * <span class="token keyword">@param</span>  <span class="token class-name">User</span>  <span class="token parameter">$user</span>\n     * <span class="token keyword">@param</span>  <span class="token class-name">Plan</span>  <span class="token parameter">$plan</span>\n     */</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span>\n        <span class="token keyword">protected</span> <span class="token class-name type-declaration">User</span> <span class="token variable">$user</span><span class="token punctuation">,</span>\n        <span class="token keyword">protected</span> <span class="token class-name type-declaration">Plan</span> <span class="token variable">$plan</span>\n    <span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token variable">$user</span>   <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;jone_doe&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token variable">$plan</span>   <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token variable">$signup</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Signup</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token variable">$plan</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$signup</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><blockquote><p>在类的构造函数中可以初始化类属性类型，属性的可访问性，以及赋默认值。</p></blockquote>',3),$={id:"允许对象的-class",tabindex:"-1"},q=(0,p._)("a",{class:"header-anchor",href:"#允许对象的-class","aria-hidden":"true"},"#",-1),U=(0,p.Uk)(),x={href:"https://wiki.php.net/rfc/class_name_literal_on_object",target:"_blank",rel:"noopener noreferrer"},E=(0,p.Uk)("允许对象的 "),P=(0,p._)("code",null,"::class",-1),W=(0,p.uE)('<div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">Conversation</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//</span>\n<span class="token punctuation">}</span>\n\n<span class="token variable">$object</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Conversation</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token function">get_class</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Conversation&quot; &quot;Conversation&quot;</span>\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>在语法上类似于类常量访问，更加直观地期望语法 <code>$object::class</code> 也能正常工作并提供与 <code>get_class($object)</code> 相同的结果。</p></blockquote>',2),C={id:"命名参数",tabindex:"-1"},M=(0,p._)("a",{class:"header-anchor",href:"#命名参数","aria-hidden":"true"},"#",-1),A=(0,p.Uk)(),j={href:"https://www.php.net/releases/8.0/zh.php#named-arguments",target:"_blank",rel:"noopener noreferrer"},I=(0,p.Uk)("命名参数"),H=(0,p.uE)('<p>这个新的 PHP 8 特性允许您根据参数名称传递函数参数，而不是它们的顺序。</p><ul><li>仅仅指定必填参数，跳过可选参数。</li><li>参数的顺序无关、自己就是文档（self-documented）</li></ul><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n\n\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">Invoice</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span>\n        <span class="token keyword">private</span> <span class="token variable">$description</span><span class="token punctuation">,</span>\n        <span class="token keyword">private</span> <span class="token variable">$total</span><span class="token punctuation">,</span>\n        <span class="token keyword">private</span> <span class="token variable">$date</span><span class="token punctuation">,</span>\n        <span class="token keyword">private</span> <span class="token variable">$paid</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token comment">//</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token variable">$invoice</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Invoice</span><span class="token punctuation">(</span>\n    <span class="token argument-name">description</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">&#39;Customer installation&#39;</span><span class="token punctuation">,</span>\n    <span class="token argument-name">total</span><span class="token punctuation">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>\n    <span class="token argument-name">date</span><span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">DateTime</span><span class="token punctuation">,</span>\n    <span class="token argument-name">paid</span><span class="token punctuation">:</span> <span class="token constant boolean">true</span><span class="token punctuation">,</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$invoice</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><blockquote><p>命名参数有一个问题是当我们修改了函数命名的时候，则在调用函数的时候的命名参数也需要一同作修改，否则会抛出：<code>Uncaught Error: Unknown named parameter</code> 的错误</p></blockquote><h2 id="新的内建函数" tabindex="-1"><a class="header-anchor" href="#新的内建函数" aria-hidden="true">#</a> 新的内建函数</h2>',5),S={id:"字符串-str-starts-with-、-str-ends-with-、str-contains-函数",tabindex:"-1"},z=(0,p._)("a",{class:"header-anchor",href:"#字符串-str-starts-with-、-str-ends-with-、str-contains-函数","aria-hidden":"true"},"#",-1),V=(0,p.Uk)(" 字符串 "),T={href:"https://wiki.php.net/rfc/add_str_starts_with_and_ends_with_functions",target:"_blank",rel:"noopener noreferrer"},D=(0,p.Uk)("str_starts_with()"),F=(0,p.Uk)("、 "),N={href:"https://wiki.php.net/rfc/str_contains",target:"_blank",rel:"noopener noreferrer"},R=(0,p.Uk)("str_ends_with()"),Y=(0,p.Uk)("、"),L={href:"https://wiki.php.net/rfc/add_str_starts_with_and_ends_with_functions",target:"_blank",rel:"noopener noreferrer"},O=(0,p.Uk)("str_contains()"),B=(0,p.Uk)(" 函数"),G=(0,p.uE)('<div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token comment"># str_starts_with</span>\n\n<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;inv_asdasdasdasdasdasd&#39;</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">str_starts_with</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;inv_&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>\n\n<span class="token comment"># str_ends_with</span>\n<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;asdasdasdasdasdasd_payment&#39;</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">str_ends_with</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;_payment&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>\n\n<span class="token comment"># str_contains</span>\n<span class="token variable">$url</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;https://example.com?foo=bar&#39;</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">str_contains</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;?&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div>',1),J={id:"get-debug-type-函数",tabindex:"-1"},K=(0,p._)("a",{class:"header-anchor",href:"#get-debug-type-函数","aria-hidden":"true"},"#",-1),Q=(0,p.Uk)(),X={href:"https://wiki.php.net/rfc/get_debug_type",target:"_blank",rel:"noopener noreferrer"},Z=(0,p.Uk)("get_debug_type 函数"),nn=(0,p.uE)('<p><code>get_debug_type</code> 函数返回给定变量的数据类型。 下面是跟 <code>gettype</code> 函数返回的数据类型对比：</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n<span class="token comment">// 字符串</span>\n<span class="token variable">$string</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;I am a string&#39;</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">get_debug_type</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string(6) &quot;string&quot; 、string(6) &quot;string&quot;</span>\n\n<span class="token comment">// 整型</span>\n<span class="token variable">$int</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">get_debug_type</span><span class="token punctuation">(</span><span class="token variable">$int</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">gettype</span><span class="token punctuation">(</span><span class="token variable">$int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string(3) &quot;int&quot; 、string(7) &quot;integer&quot;</span>\n\n<span class="token comment">// 浮点型</span>\n<span class="token variable">$float</span> <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">get_debug_type</span><span class="token punctuation">(</span><span class="token variable">$float</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">gettype</span><span class="token punctuation">(</span><span class="token variable">$float</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string(5) &quot;float&quot; 、string(6) &quot;double&quot;</span>\n\n<span class="token comment">// 数组</span>\n<span class="token variable">$array</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">get_debug_type</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">gettype</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string(5) &quot;array&quot; 、string(5) &quot;array&quot;</span>\n\n<span class="token comment">// 对象</span>\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token variable">$object</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">get_debug_type</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">gettype</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string(4) &quot;User&quot; 、string(6) &quot;object&quot;</span>\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div>',2),sn={id:"weak-map-类",tabindex:"-1"},an=(0,p._)("a",{class:"header-anchor",href:"#weak-map-类","aria-hidden":"true"},"#",-1),pn=(0,p.Uk)(),en={href:"https://wiki.php.net/rfc/weak_maps",target:"_blank",rel:"noopener noreferrer"},tn=(0,p.Uk)("Weak Map 类"),ln=(0,p.uE)('<p>Weak map 允许存储链接到对象的任意数据，而不会泄漏任何内存。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token variable">$map</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token variable">$map</span><span class="token punctuation">[</span><span class="token variable">$user</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$map</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// int(1)</span>\n\n<span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$map</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// int(0)</span>\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div>',2),on={href:"https://php.watch/versions/8.0/weakmap",target:"_blank",rel:"noopener noreferrer"},cn=(0,p.Uk)("更多相关查看这里"),rn={id:"联合类型",tabindex:"-1"},un=(0,p._)("a",{class:"header-anchor",href:"#联合类型","aria-hidden":"true"},"#",-1),kn=(0,p.Uk)(),bn={href:"https://www.php.net/releases/8.0/zh.php#union-types",target:"_blank",rel:"noopener noreferrer"},mn=(0,p.Uk)("联合类型"),dn=(0,p.uE)('<p>相较于以前的 PHPDoc 声明类型的组合，现在可以用原生支持的联合类型声明取而代之，并在运行时得到校验。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> <span class="token class-name">User</span><span class="token operator">|</span><span class="token keyword type-declaration">null</span> <span class="token variable">$user</span><span class="token punctuation">;</span> <span class="token comment">// 可以在定义类属性时定义对应属性类型为联合类型</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">makeFriendsWith</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">|</span><span class="token keyword type-declaration">null</span> <span class="token variable">$user</span><span class="token punctuation">)</span> <span class="token comment">// 联合类型声明,在php8之前不允许这样定义参数类型</span>\n    <span class="token punctuation">{</span>\n        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">user</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token punctuation">;</span>\n        <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Yay friends&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getFriends</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token operator">?</span><span class="token class-name return-type">User</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">user</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token variable">$joe</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">;</span>\n<span class="token variable">$sam</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">;</span>\n\n<span class="token variable">$joe</span><span class="token operator">-&gt;</span><span class="token function">makeFriendsWith</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div>',2),hn={id:"attributes-注解",tabindex:"-1"},gn=(0,p._)("a",{class:"header-anchor",href:"#attributes-注解","aria-hidden":"true"},"#",-1),vn=(0,p.Uk)(),wn={href:"https://www.php.net/manual/zh/language.attributes.overview.php",target:"_blank",rel:"noopener noreferrer"},fn=(0,p.Uk)("Attributes 注解"),yn=(0,p._)("p",null,"注解功能提供了代码中的声明部分都可以添加结构化、机器可读的元数据的能力， 注解的目标可以是类、方法、函数、参数、属性、类常量。",-1),_n=(0,p.Uk)("通过 "),$n={href:"https://www.php.net/manual/zh/book.reflection.php",target:"_blank",rel:"noopener noreferrer"},qn=(0,p.Uk)("反射 API"),Un=(0,p.Uk)(" 可在运行时获取注解所定义的元数据。"),xn=(0,p.uE)('<p>因此注解可以成为直接嵌入代码的配置式语言。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n<span class="token attribute"><span class="token delimiter punctuation">#[</span><span class="token attribute-content"><span class="token attribute-class-name class-name">Attribute</span></span><span class="token delimiter punctuation">]</span></span>\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">ApplyMiddleware</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword type-declaration">string</span> <span class="token variable">$middleware</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token comment">//</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword return-type">string</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">middleware</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n\n<span class="token attribute"><span class="token delimiter punctuation">#[</span><span class="token attribute-content"><span class="token attribute-class-name class-name">ApplyMiddleware</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;class&#39;</span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">]</span></span>\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">MyController</span>\n<span class="token punctuation">{</span>\n    <span class="token attribute"><span class="token delimiter punctuation">#[</span><span class="token attribute-content"><span class="token attribute-class-name class-name">ApplyMiddleware</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;property&#39;</span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">]</span></span>\n    <span class="token keyword">protected</span> <span class="token variable">$myProperty</span><span class="token punctuation">;</span>\n\n\n    <span class="token attribute"><span class="token delimiter punctuation">#[</span><span class="token attribute-content"><span class="token attribute-class-name class-name">ApplyMiddleware</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;method&#39;</span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">]</span></span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token variable">$controller</span>      <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyController</span><span class="token punctuation">;</span>\n<span class="token variable">$reflectionClass</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReflectionClass</span><span class="token punctuation">(</span><span class="token variable">$controller</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 类</span>\n<span class="token variable">$attributes</span>      <span class="token operator">=</span> <span class="token variable">$reflectionClass</span><span class="token operator">-&gt;</span><span class="token function">getAttributes</span><span class="token punctuation">(</span><span class="token class-name static-context">ApplyMiddleware</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token variable">$middleware</span>      <span class="token operator">=</span> <span class="token variable">$attributes</span><span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token operator">?-&gt;</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$middleware</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string(5) &quot;class&quot;</span>\n\n<span class="token comment">// 方法</span>\n<span class="token variable">$attributes</span>      <span class="token operator">=</span> <span class="token variable">$reflectionClass</span><span class="token operator">-&gt;</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;index&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token variable">$middleware</span> <span class="token operator">=</span> <span class="token variable">$attributes</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">?-&gt;</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$middleware</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string(6) &quot;method&quot;</span>\n\n<span class="token comment">// 属性</span>\n<span class="token variable">$attributes</span> <span class="token operator">=</span> <span class="token variable">$reflectionClass</span><span class="token operator">-&gt;</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;myProperty&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token variable">$middleware</span> <span class="token operator">=</span> <span class="token variable">$attributes</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">?-&gt;</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$middleware</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string(8) &quot;property&quot;</span>\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div>',2),En={id:"throw-作为表达式",tabindex:"-1"},Pn=(0,p._)("a",{class:"header-anchor",href:"#throw-作为表达式","aria-hidden":"true"},"#",-1),Wn=(0,p.Uk)(),Cn={href:"https://wiki.php.net/rfc/throw_expression",target:"_blank",rel:"noopener noreferrer"},Mn=(0,p.Uk)("throw 作为表达式"),An=(0,p.uE)('<p>允许在接受表达式的任何上下文中使用 <code>throw</code> 关键字。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n<span class="token comment">// callable</span>\n<span class="token variable">$callable</span> <span class="token operator">=</span> <span class="token keyword">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// $value 的值仅不为null</span>\n<span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$nullableVariable</span> <span class="token operator">??</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InvalidArgumentException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// $value 的值仅为true</span>\n<span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$falsableValue</span> <span class="token operator">?</span><span class="token punctuation">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InvalidArgumentException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// 跟使用if表达式一样，让代码变得简洁</span>\n<span class="token variable">$condition</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token variable">$condition</span> <span class="token operator">||</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token variable">$condition</span> <span class="token keyword">and</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token variable">$condition</span> <span class="token keyword">or</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div>',2),jn={id:"无变量捕捉",tabindex:"-1"},In=(0,p._)("a",{class:"header-anchor",href:"#无变量捕捉","aria-hidden":"true"},"#",-1),Hn=(0,p.Uk)(),Sn={href:"https://php.watch/versions/8.0/catch-exception-type",target:"_blank",rel:"noopener noreferrer"},zn=(0,p.Uk)("无变量捕捉"),Vn=(0,p.uE)('<p>PHP 8.0 及更高版本允许使用 try/catch 块，其中 catch() 语句不会将异常本身捕获到变量中。</p><p>在 PHP 8.0 之前，典型的 PHP try/catch 块必须在 catch 语句中捕获异常：</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>\n  <span class="token comment">// try something</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified"><span class="token punctuation">\\</span>InvalidArgumentException</span> <span class="token variable">$ex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// &quot;$ex&quot; is required</span>\n  <span class="token comment">// handle the exception</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>有时，异常类型（如<code>\\InvalidArgumentException</code>）足以决定异常的处理方式，并将异常捕获到一个变量中（如上例中的$ex），PHP 8.0 允许删除异常捕获。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>\n    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InvalidArgumentException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InvalidArgumentException</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;Something went wrong.&quot;</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="highlight-lines"><br><br><div class="highlight-line"> </div><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>确保在程序中捕获的异常类型的粒度足以传达异常的含义。 例如，如果打算记录事件，则在不捕获异常的情况下捕获通配符 <code>\\Exception</code> 或 <code>\\Throwable</code> 可能不是一个好习惯。</p>',6),Tn={id:"新的混合伪类型",tabindex:"-1"},Dn=(0,p._)("a",{class:"header-anchor",href:"#新的混合伪类型","aria-hidden":"true"},"#",-1),Fn=(0,p.Uk)(),Nn={href:"https://php.watch/versions/8.0/mixed-type",target:"_blank",rel:"noopener noreferrer"},Rn=(0,p.Uk)("新的混合伪类型"),Yn=(0,p.uE)('<p>当函数的参数和返回值没有定义时，默认为 <code>mixed</code> 类型的返回值。</p><p><code>mixed</code> 等同于联合类型 <code>string|int|float|bool|null|array|object|callable|resource</code></p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">function</span> <span class="token function-definition function">dump</span><span class="token punctuation">(</span><span class="token keyword type-hint">mixed</span> <span class="token variable">$var</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">dump</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;test&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="highlight-lines"><div class="highlight-line"> </div><br><br><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>注意：<code>mixed</code> 不能跟其他类型一起组合成联合类型。例如：<code>function (mixed|FooClass $bar): int|mixed {}</code> 会抛出错误：<code>Fatal error: Type mixed can only be used as a standalone type in ... on line ...</code></p></blockquote>',4),Ln={id:"新-stringable-接口",tabindex:"-1"},On=(0,p._)("a",{class:"header-anchor",href:"#新-stringable-接口","aria-hidden":"true"},"#",-1),Bn=(0,p.Uk)(),Gn={href:"https://php.watch/versions/8.0/stringable",target:"_blank",rel:"noopener noreferrer"},Jn=(0,p.Uk)("新 Stringable 接口"),Kn=(0,p.uE)('<div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword return-type">string</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string single-quoted-string">&#39;The username&#39;</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">passString</span><span class="token punctuation">(</span><span class="token keyword type-declaration">string</span><span class="token operator">|</span><span class="token class-name">Stringable</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span><span class="token operator">|</span><span class="token class-name">Stringable</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token variable">$string</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token function">var_dump</span><span class="token punctuation">(</span>\n    <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// string(12) &quot;The username&quot;</span>\n    <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Stringable</span><span class="token punctuation">,</span> <span class="token comment">// bool(true) </span>\n    <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">passString</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">)</span> <span class="token comment">// object(User)#2 (0) {}</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div>',1),Qn={id:"尾随逗号",tabindex:"-1"},Xn=(0,p._)("a",{class:"header-anchor",href:"#尾随逗号","aria-hidden":"true"},"#",-1),Zn=(0,p.Uk)(),ns={href:"https://php.watch/versions/8.0/trailing-comma-parameter-use-list",target:"_blank",rel:"noopener noreferrer"},ss=(0,p.Uk)("尾随逗号"),as=(0,p.uE)('<p>PHP 8.0 语法允许在参数列表和闭包使用列表中留下尾随逗号。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span>\n        <span class="token keyword">public</span> <span class="token keyword type-declaration">string</span> <span class="token variable">$name</span><span class="token punctuation">,</span>\n        <span class="token keyword">protected</span> <span class="token keyword type-declaration">int</span> <span class="token variable">$age</span><span class="token punctuation">,</span>\n        <span class="token keyword">private</span> <span class="token keyword type-declaration">string</span> <span class="token variable">$email</span><span class="token punctuation">,</span>\n        <span class="token keyword">public</span> <span class="token keyword type-declaration">bool</span> <span class="token variable">$is_admin</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span>\n    <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>\n    <span class="token string single-quoted-string">&#39;Curder&#39;</span><span class="token punctuation">,</span>\n    <span class="token number">30</span><span class="token punctuation">,</span>\n    <span class="token string single-quoted-string">&#39;q.curder@gmail.com&#39;</span><span class="token punctuation">,</span>\n    <span class="token constant boolean">true</span><span class="token punctuation">,</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">use</span> <span class="token punctuation">(</span><span class="token variable">$foo</span><span class="token punctuation">,</span> <span class="token variable">$bar</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n</span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div>',2),ps={id:"valueerror-错误类型",tabindex:"-1"},es=(0,p._)("a",{class:"header-anchor",href:"#valueerror-错误类型","aria-hidden":"true"},"#",-1),ts=(0,p.Uk)(),ls={href:"https://php.watch/versions/8.0/ValueError",target:"_blank",rel:"noopener noreferrer"},os=(0,p.Uk)("ValueError 错误类型"),cs=(0,p.uE)('<p>PHP 8 引入了一种称为 <code>ValueError</code> 的新型异常。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>\n    <span class="token variable">$random_element</span> <span class="token operator">=</span> <span class="token function">array_rand</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 函数传递错误的参数</span>\n    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$random_element</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ValueError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// Something went error</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div>',2),rs={render:function(n,s){const a=(0,p.up)("OutboundLink");return(0,p.wg)(),(0,p.iD)(p.HY,null,[e,(0,p._)("h2",t,[l,o,(0,p._)("a",c,[r,(0,p.Wm)(a)])]),i,(0,p._)("h2",u,[k,b,(0,p._)("a",m,[d,(0,p.Wm)(a)])]),h,(0,p._)("h2",g,[v,w,(0,p._)("a",f,[y,(0,p.Wm)(a)])]),_,(0,p._)("h2",$,[q,U,(0,p._)("a",x,[E,P,(0,p.Wm)(a)])]),W,(0,p._)("h2",C,[M,A,(0,p._)("a",j,[I,(0,p.Wm)(a)])]),H,(0,p._)("h3",S,[z,V,(0,p._)("a",T,[D,(0,p.Wm)(a)]),F,(0,p._)("a",N,[R,(0,p.Wm)(a)]),Y,(0,p._)("a",L,[O,(0,p.Wm)(a)]),B]),G,(0,p._)("h3",J,[K,Q,(0,p._)("a",X,[Z,(0,p.Wm)(a)])]),nn,(0,p._)("h2",sn,[an,pn,(0,p._)("a",en,[tn,(0,p.Wm)(a)])]),ln,(0,p._)("p",null,[(0,p._)("a",on,[cn,(0,p.Wm)(a)])]),(0,p._)("h2",rn,[un,kn,(0,p._)("a",bn,[mn,(0,p.Wm)(a)])]),dn,(0,p._)("h2",hn,[gn,vn,(0,p._)("a",wn,[fn,(0,p.Wm)(a)])]),yn,(0,p._)("p",null,[_n,(0,p._)("a",$n,[qn,(0,p.Wm)(a)]),Un]),xn,(0,p._)("h2",En,[Pn,Wn,(0,p._)("a",Cn,[Mn,(0,p.Wm)(a)])]),An,(0,p._)("h2",jn,[In,Hn,(0,p._)("a",Sn,[zn,(0,p.Wm)(a)])]),Vn,(0,p._)("h2",Tn,[Dn,Fn,(0,p._)("a",Nn,[Rn,(0,p.Wm)(a)])]),Yn,(0,p._)("h2",Ln,[On,Bn,(0,p._)("a",Gn,[Jn,(0,p.Wm)(a)])]),Kn,(0,p._)("h2",Qn,[Xn,Zn,(0,p._)("a",ns,[ss,(0,p.Wm)(a)])]),as,(0,p._)("h2",ps,[es,ts,(0,p._)("a",ls,[os,(0,p.Wm)(a)])]),cs],64)}}}}]);